$(function(){var e=config.VersionControl;$(".InputfieldWrapper#VersionControlHistory").on("click",".edit-comment",function(){var i=$(this).parent("td").prev("td"),t=$(this).data("revision"),r=prompt(e.i18n.commentPrompt,i.text());return null!==r&&$.post(e.processPage+"comment",{revision:t,comment:r},function(e){i.text(e).effect("highlight",{},500)}),!1}),$(".InputfieldWrapper#VersionControlHistory").on("change","#history_filters select",function(e){var i="";$(this).parents("#history_filters:first").find("input, select").each(function(){i&&(i+="&"),i+=$(this).attr("name")+"="+$(this).val(),e.stopPropagation()}),window.location.search=i});var i=$("#VersionControlHistory");i.length&&i.children("ul:first").data("active")&&$("a#_"+i.attr("id")).trigger("click"),$("form#ProcessPageEdit").on("submit",function(){$(this).find("#history_filters").remove()}),i.on("click","a.preview",function(){var e=$(this);return $("body").append('<div id="preview-overlay"></div>').append('<div id="preview"><iframe src="'+e.attr("href")+'" seamless></iframe></div>'),$("#preview iframe").on("load",function(i){$("#preview").addClass("loaded"),$(i.target.contentWindow).on("beforeunload",function(i){i.preventDefault(),t(e)})}),$("#preview-overlay").fadeIn(),$("#preview").show().animate({right:0},500,function(){$("body").addClass("preview")}),$(document).on("keyup.preview",function(){t(e)}).on("click.preview",function(){t(e)}),!1});var t=function(e){return $(window).off("blur.preview"),$(document).off("keyup.preview"),$(document).off("click.preview"),$("body").removeClass("preview"),$("#preview-overlay").fadeOut(function(){$(this).remove()}),$("#preview").animate({right:"-80%"},500,function(){$(this).remove()}),e.parents("tr:first").effect("highlight",{},1500),!1};i.on("click","a.restore",function(){return confirm(e.i18n.confirmRestore)})});
