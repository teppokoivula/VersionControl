$(function(){var o=config.VersionControl,e=($("#VersionControlHistory").on("click",".history-tab__button--edit-comment",function(){var t=$(this).parent("td").prev("td"),e=$(this).data("revision"),i=prompt(o.i18n.commentPrompt,t.text());return null!==i&&$.post(o.processPage+"comment",{revision:e,comment:i},function(e){t.text(e).effect("highlight",{},500)}),!1}),$("#VersionControlHistory").on("change","#history_filters select",function(e){var t="";$(this).parents("#history_filters:first").find("input, select").each(function(){t&&(t+="&"),t+=$(this).attr("name")+"="+$(this).val(),e.stopPropagation()}),window.location.search=t}),$("#VersionControlHistory")),i=(e.length&&e.children("ul:first").data("active")&&$("#_"+e.attr("id")).trigger("click"),$("#ProcessPageEdit").on("submit",function(){$(this).find("#history_filters").remove()}),e.on("click",".history-tab__button--preview",function(){var t=$(this);return $("body").append('<div id="preview-overlay"></div>').append('<div id="preview"><iframe src="'+t.attr("href")+'" seamless></iframe></div>'),$("#preview iframe").on("load",function(e){$("#preview").addClass("loaded"),$(e.target.contentWindow).on("beforeunload",function(e){e.preventDefault(),i(t)})}),$("#preview-overlay").fadeIn(),$("#preview").show().animate({right:0},500,function(){$("body").addClass("version-control--preview")}),$(document).on("keyup.preview",function(){i(t)}).on("click.preview",function(){i(t)}),!1}),function(e){return $(window).off("blur.preview"),$(document).off("keyup.preview"),$(document).off("click.preview"),$("body").removeClass("version-control--preview"),$("#preview-overlay").fadeOut(function(){$(this).remove()}),$("#preview").animate({right:"-80%"},500,function(){$(this).remove()}),e.parents("tr:first").effect("highlight",{},1500),!1});e.on("click",".history-tab__button--restore",function(){return confirm(o.i18n.confirmRestore)})});